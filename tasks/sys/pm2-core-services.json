[
  {
    "name": "xtuple-server-{xt.version}-{xt.name}",
    "user": "{xt.name}",
    "script": "/usr/sbin/xtuple/{xt.version}/{xt.name}/main.js",
    "args": "[ '-c', '/etc/xtuple/{xt.version}/{xt.name}/config.js' ]",
    "env": {
      "NODE_ENV": "production",
      "HOME": "{xt.userhome}",
      "PORT": "{xt.port}",
      "XT_PROCESS": "xtuple-server-{xt.version}",
      "XT_NAME": "{xt.name}",
      "XT_VERSION": "{xt.version}",
      "XT_DOMAIN": "{nginx.domain}",
      "XT_URL": "/",
      "XT_SCHEDULE": "Always On"
    },
    "exec_mode": "fork_mode",
    "out_file": "{xt.logdir}/node-web-access.log",
    "error_file": "{xt.logdir}/node-web-error.log",
    "pid_file": "{xt.statedir}/node-web.pid",
    "min_uptime": 30000
  },
  {
    "name": "xtuple-healthfeed-{xt.version}-{xt.name}",
    "user": "{xt.name}",
    "script": "/usr/lib/node_modules/pm2/lib/HttpInterface.js",
    "env": {
      "NODE_ENV": "production",
      "HOME": "{xt.userhome}",
      "PORT": "{nginx.healthfeedport}",
      "XT_PROCESS": "xtuple-healthfeed",
      "XT_NAME": "{xt.name}",
      "XT_VERSION": "{xt.version}",
      "XT_DOMAIN": "{nginx.domain}",
      "XT_URL": "/_healthfeed",
      "XT_SCHEDULE": "Always On",
      "PM2_API_PORT": "{nginx.healthfeedport}"
    },
    "exec_mode": "fork_mode",
    "out_file": "{xt.logdir}/pm2-web-access.log",
    "error_file": "{xt.logdir}/pm2-web-error.log",
    "pid_file": "{xt.statedir}/pm2-web.pid",
    "min_uptime": 30000
  },
  {
    "name": "xtuple-snapshotmgr-{xt.version}-{xt.name}",
    "user": "{xt.name}",
    "script": "/usr/bin/xtuple-server",
    "args": "[ 'backup', '--xt-name', '{xt.name}', '--xt-version', '{xt.version}' ]",
    "cron_restart": "{pg.snapschedule}",
    "env": {
      "NODE_ENV": "production",
      "HOME": "{xt.userhome}",
      "PORT": "{pg.cluster.port}",
      "XT_PROCESS": "xtuple-snapshotmgr-{xt.version}",
      "XT_NAME": "{xt.name}",
      "XT_VERSION": "{xt.version}",
      "XT_DOMAIN": "{nginx.domain}",
      "XT_URL": "--",
      "XT_SCHEDULE": "{pg.snapschedule}"
    },
    "exec_mode": "fork_mode",
    "out_file": "{xt.logdir}/pg-snapshot.log",
    "error_file": "{xt.logdir}/pg-snapshot-error.log",
    "pid_file": "{xt.statedir}/pg-snapshot.pid",
    "min_uptime": 5000
  }
]
