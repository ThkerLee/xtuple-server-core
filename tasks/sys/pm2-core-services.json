[
  {
    "name": "xtuple-server-{xt.version}-{xt.name}",
    "user": "{xt.name}",
    "script": "/usr/sbin/xtuple/{xt.version}/{xt.name}/main.js",
    "args": "[ '-c /etc/xtuple/{xt.version}/{xt.name}/config.js' ]",
    "env": {
      "NODE_ENV": "production",
      "PWD": "{xt.userhome}",
      "PORT": "{xt.port}",
      "XT_PROCESS": "xtuple-server-{xt.version}",
      "XT_NAME": "{xt.name}",
      "XT_VERSION": "{xt.version}",
      "XT_DOMAIN": "{nginx.domain}",
      "XT_URL": "{nginx.domain}",
      "XT_SCHEDULE": "Always On"
    },
    "exec_mode": "fork_mode",
    "out_file": "{xt.logdir}/node-web-access.log",
    "error_file": "{xt.logdir}/node-web-error.log",
    "pid_file": "{xt.statedir}/node-web.pid",
    "min_uptime": 30000
  },
  {
    "name": "xtuple-postgres-{xt.version}-{xt.name}",
    "user": "{xt.name}",
    "interpreter": "/usr/lib/postgresql/{pg.version}/bin/postgres",
    "script": "",
    "args": "[ '-D', '/var/lib/postgresql/{pg.version}/{xt.name}', '-c', 'config_file=/etc/postgresql/{pg.version}/{xt.name}/postgresql.conf' ]",
    "env": {
      "PORT": "{pg.cluster.port}",
      "PWD": "{xt.userhome}",
      "XT_PROCESS": "xtuple-postgres-{pg.version}",
      "XT_NAME": "{xt.name}",
      "XT_VERSION": "{xt.version}",
      "XT_DOMAIN": "{nginx.domain}",
      "XT_URL": "/var/run/postgresql/.s.PGSQL.{pg.cluster.port}",
      "XT_SCHEDULE": "Always On"
    },
    "exec_mode": "fork_mode",
    "out_file": "{pg.logdir}/postgresql-{pg.version}-{xt.name}.log",
    "error_file": "{pg.logdir}/postgresql-{pg.version}-{xt.name}-error.log",
    "pid_file": "/var/run/postgresql/{pg.version}-{xt.name}.pid",
    "min_uptime": 30000
  },
  {
    "name": "xtuple-healthfeed-{xt.version}-{xt.name}",
    "user": "{xt.name}",
    "script": "/usr/lib/node_modules/pm2/lib/HttpInterface.js",
    "env": {
      "NODE_ENV": "production",
      "PWD": "{xt.userhome}",
      "PORT": "{nginx.healthfeedport}",
      "XT_PROCESS": "xtuple-healthfeed",
      "XT_NAME": "{xt.name}",
      "XT_VERSION": "{xt.version}",
      "XT_DOMAIN": "{nginx.domain}",
      "XT_URL": "{nginx.healthfeedurl}",
      "XT_SCHEDULE": "Always On",
      "PM2_API_PORT": "{nginx.healthfeedport}"
    },
    "exec_mode": "fork_mode",
    "out_file": "{xt.logdir}/pm2-web-access.log",
    "error_file": "{xt.logdir}/pm2-web-error.log",
    "pid_file": "{xt.statedir}/pm2-web.pid",
    "min_uptime": 30000
  }
]

